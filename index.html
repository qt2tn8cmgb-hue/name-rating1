<!DOCTYPE html>
<html lang="ru">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Choice</title>

<style>

/* ===== RESET ===== */
* {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}

/* ===== THEMES ===== */
:root {
    --bg: #0b0f1a;
    --bg2: #141a2e;
    --card: rgba(255,255,255,0.08);
    --text: #ffffff;
    --accent: #ff4b7d;
}

body.light {
    --bg: #f4f6fb;
    --bg2: #e3e8f3;
    --card: rgba(0,0,0,0.06);
    --text: #111;
    --accent: #4f7cff;
}

/* ===== BODY ===== */
body {
    margin: 0;
    height: 100vh;
    background: linear-gradient(180deg, var(--bg), var(--bg2));
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro", Arial, sans-serif;
    color: var(--text);
    display: flex;
    justify-content: center;
    align-items: center;
    transition: 0.4s;
}

/* ===== APP CONTAINER ===== */
.app {
    width: 100%;
    max-width: 420px;
    height: 100vh;
    padding: 24px 18px env(safe-area-inset-bottom);
    display: flex;
    flex-direction: column;
    justify-content: center;
}

/* ===== TEXT ===== */
h1 {
    font-size: 28px;
    margin-bottom: 24px;
    text-align: center;
}

/* ===== INPUT ===== */
input {
    width: 100%;
    padding: 18px;
    font-size: 18px;
    border-radius: 18px;
    border: none;
    background: var(--card);
    color: var(--text);
    outline: none;
}

/* ===== START BUTTON ===== */
.start-btn {
    margin-top: 20px;
    padding: 18px;
    font-size: 18px;
    border-radius: 18px;
    border: none;
    background: var(--accent);
    color: white;
}

/* ===== BATTLE ===== */
.battle {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

/* ===== CHOICE CARD ===== */
.choice {
    padding: 26px;
    border-radius: 22px;
    background: var(--card);
    font-size: 22px;
    text-align: center;
    backdrop-filter: blur(14px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    transition: transform 0.15s, box-shadow 0.15s;
}

.choice:active {
    transform: scale(0.96);
    box-shadow: 0 6px 18px rgba(0,0,0,0.3);
}

/* ===== TOGGLE ===== */
.toggle {
    position: fixed;
    top: 16px;
    right: 16px;
    padding: 10px 14px;
    border-radius: 14px;
    background: var(--card);
    border: none;
    color: var(--text);
}

/* ===== HEART ===== */
.heart {
    position: fixed;
    font-size: 26px;
    animation: fly 1s ease forwards;
    pointer-events: none;
}

/* ===== TOP ===== */
.place {
    padding: 24px;
    border-radius: 22px;
    background: var(--card);
    font-size: 22px;
    margin-bottom: 16px;
    animation: pop 0.4s ease;
}

.first {
    font-size: 30px;
    box-shadow: 0 0 35px rgba(255,215,0,0.8);
    animation: winner 1.2s infinite alternate;
}

/* ===== ANIMATIONS ===== */
@keyframes fly {
    from { opacity: 1; transform: translateY(0) scale(1); }
    to   { opacity: 0; transform: translateY(-120px) scale(1.6); }
}

@keyframes pop {
    from { opacity: 0; transform: scale(0.85); }
    to   { opacity: 1; transform: scale(1); }
}

@keyframes winner {
    from { transform: scale(1); }
    to   { transform: scale(1.05); }
}

</style>
</head>

<body>

<button class="toggle" onclick="toggleTheme()">üåô / ‚òÄÔ∏è</button>

<div class="app">

<!-- LOGIN -->
<div id="login">
    <h1>–í–≤–µ–¥–∏—Ç–µ –∏–º—è</h1>
    <input id="username" placeholder="–í–∞—à–µ –∏–º—è">
    <button class="start-btn" onclick="startApp()">–ù–∞—á–∞—Ç—å</button>
</div>

<!-- GAME -->
<div id="game" style="display:none">
    <h1>–í—ã–±–µ—Ä–∏—Ç–µ</h1>
    <div id="battle" class="battle"></div>
</div>

<!-- RESULT -->
<div id="result" style="display:none"></div>

</div>

<script>

/* ===== NAMES ===== */
const girls = ["–°–µ–ª–µ–Ω","–®–∞—Ö–Ω–æ–∑–∞","–ú—É–±–∏–Ω–∞","–Ø–º–∏","–†–æ–∑–∏—è","–ú–∞–ª–∏–∫–∞","–ê–∏—à–∞"];
const boys  = ["–ê–∑–∏–∑–±–µ–∫","–ê–±–¥—É–ª–ª–æ—Ö","–ò—Å—Ä–æ–∏–ª","–ê—Å–∞–¥–±–µ–∫","–¢–∏–º—É—Ä","–ò–º—Ä–∞–Ω","–ò—Å—Ñ–∞–Ω–¥–∏–æ—Ä","–ë–æ—Ä–∏—Å"];

let pool = [];
let ranking = [];
let userName = "";

/* ===== THEME ===== */
function toggleTheme() {
    document.body.classList.toggle("light");
}

/* ===== START ===== */
function startApp() {
    userName = document.getElementById("username").value.trim();
    if (!userName) return alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è");

    pool = girls.includes(userName) ? [...boys] : [...girls];

    document.getElementById("login").style.display = "none";
    document.getElementById("game").style.display = "block";
    nextRound();
}

/* ===== ROUND ===== */
function nextRound() {

    if (pool.length === 1) {
        ranking.unshift(pool[0]);
        showTop();
        sendToGoogle();
        return;
    }

    let a = pool.shift();
    let b = pool.shift();

    let battle = document.getElementById("battle");
    battle.innerHTML = "";

    battle.appendChild(makeChoice(a, b));
    battle.appendChild(makeChoice(b, a));
}

/* ===== CARD ===== */
function makeChoice(name, other) {

    let div = document.createElement("div");
    div.className = "choice";
    div.innerText = name;

    div.onclick = (e) => {
        if (navigator.vibrate) navigator.vibrate(30);
        showHeart(e.clientX, e.clientY);
        pool.push(name);
        ranking.unshift(other);
        nextRound();
    };

    return div;
}

/* ===== HEART ===== */
function showHeart(x, y) {
    let h = document.createElement("div");
    h.className = "heart";
    h.innerText = "üíñ";
    h.style.left = x + "px";
    h.style.top = y + "px";
    document.body.appendChild(h);
    setTimeout(() => h.remove(), 1000);
}

/* ===== TOP ===== */
function showTop() {
    document.getElementById("game").style.display = "none";
    let r = document.getElementById("result");
    r.style.display = "block";

    r.innerHTML = `
        <h1>üèÜ –¢–æ–ø 3</h1>
        <div class="place first">ü•á ${ranking[0]}</div>
        <div class="place">ü•à ${ranking[1]}</div>
        <div class="place">ü•â ${ranking[2]}</div>
    `;
}

/* ===== GOOGLE SHEETS ===== */
function sendToGoogle() {

    let url = "https://docs.google.com/forms/d/e/1FAIpQLSdjxIqr3wttTjMFRQH99vHdvNEHALEA1oOI8rU_n-vE0-5W0Q/formResponse";

    let data = new FormData();
    data.append("entry.2137641526", userName);
    data.append("entry.42689067", ranking.join(" ‚Üí "));

    fetch(url, { method: "POST", mode: "no-cors", body: data });
}

</script>

</body>
</html>